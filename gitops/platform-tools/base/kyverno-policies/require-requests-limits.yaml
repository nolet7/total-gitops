apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata: { name: require-requests-limits }
spec:
  validationFailureAction: Audit
  background: true
  rules:
    - name: require-requests-limits
      match: { resources: { kinds: [Pod] } }
      validate:
        message: "CPU/memory requests & limits are required."
        pattern:
          spec:
            containers:
              - resources:
                  requests: { cpu: "?*", memory: "?*" }
                  limits:   { cpu: "?*", memory: "?*" }

